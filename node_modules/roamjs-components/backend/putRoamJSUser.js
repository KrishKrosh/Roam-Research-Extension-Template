"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.awsPutRoamJSUser = void 0;
const tslib_1 = require("tslib");
const axios_1 = tslib_1.__importDefault(require("axios"));
const headers_1 = tslib_1.__importDefault(require("./headers"));
const putRoamJSUser = (token, data, extensionId = process.env.ROAMJS_EXTENSION_ID || "", email = process.env.ROAMJS_EMAIL, dev = process.env.NODE_ENV === "development") => axios_1.default
    .put(`https://lambda.roamjs.com/user`, data, {
    headers: Object.assign({ Authorization: `Bearer ${Buffer.from(`${email}:${process.env.ROAMJS_DEVELOPER_TOKEN}`).toString("base64")}`, "x-roamjs-token": token, "x-roamjs-extension": extensionId }, (dev
        ? {
            "x-roamjs-dev": "true",
        }
        : {})),
})
    .then((r) => r.data);
const awsPutRoamJSUser = (event, data) => putRoamJSUser(event.headers.Authorization || event.headers.authorization || "", data)
    .then((data) => ({
    statusCode: 200,
    body: JSON.stringify(data),
    headers: headers_1.default,
}))
    .catch((e) => {
    var _a;
    return ({
        statusCode: 401,
        body: (_a = e.response) === null || _a === void 0 ? void 0 : _a.data,
        headers: headers_1.default,
    });
});
exports.awsPutRoamJSUser = awsPutRoamJSUser;
exports.default = putRoamJSUser;
//# sourceMappingURL=putRoamJSUser.js.map